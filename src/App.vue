<template>
    <div id="app">
        <nprogress-container></nprogress-container>
        <navbar :show="true"></navbar>
        <sidebar :show="config.sidebar"></sidebar>
        <app-main></app-main>
        <footer-bar></footer-bar>
    </div>
</template>
<script>
import NprogressContainer from 'vue-nprogress/src/NprogressContainer'
import {
    Navbar,
    AppMain,
    FooterBar,
    Sidebar
} from 'components/layout/'
export default {
    name: 'app',
    components: {
        Navbar,
        Sidebar,
        AppMain,
        FooterBar,
        NprogressContainer
    },
    beforeMount() {
        const config = this.config
        const {
            body
        } = document
        const WIDTH = 768
        const RATIO = 3

        const handler = () => {
            if (!document.hidden) {
                let rect = body.getBoundingClientRect()
                config.mobile = rect.width - RATIO < WIDTH
                config.sidebar = !config.mobile
            }
        }

        document.addEventListener('visibilitychange', handler)
        window.addEventListener('DOMContentLoaded', handler)
        window.addEventListener('resize', handler)
    },

    computed: {
        config() {
            return this.$store.state.config
        }
    }

}
</script>
<style lang="scss">
@import '~animate.css';
.animated {
    animation-duration: .377s;
}

@import '~bulma';
$fa-font-path: '~font-awesome/fonts/';
@import '~font-awesome/scss/font-awesome';
.nprogress-container {
    position: fixed !important;
    width: 100%;
    height: 50px;
    z-index: 2048;
    pointer-events: none;
    #nprogress {
        $color: #48e79a;
        .bar {
            background: $color;
        }
        .peg {
            box-shadow: 0 0 10px $color, 0 0 5px $color;
        }
        .spinner-icon {
            border-top-color: $color;
            border-left-color: $color;
        }
    }
}
</style>
